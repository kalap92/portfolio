# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://coffeescript.org/

$ ->
  count = 1
  frequency_list = gon.trending_hashtags.map (word) ->
    {
      'text': word
      'size': count += 2
    }

  color = d3.scaleLinear().domain([
    0
    1
    2
    3
    4
    5
    6
    10
    15
    20
    100
  ]).range([
    '#ddd'
    '#ccc'
    '#bbb'
    '#aaa'
    '#999'
    '#888'
    '#777'
    '#666'
    '#555'
    '#444'
    '#333'
    '#222'
  ])

  draw = (words) ->
    d3.select('body').select('div.wordcloud').append('svg').attr('width', '100%').attr('height', 350).attr('class', 'wordcloud').append('g').attr('transform', 'translate(320,400)').selectAll('text').data(words).enter().append('text').style('font-size', (d) ->
      d.size + 'px'
    ).style('fill', (d, i) ->
      color i
    ).attr('transform', (d) ->
      'translate(' + [
        d.x
        d.y
      ] + ')rotate(' + d.rotate + ')'
    ).text (d) ->
      d.text
    return

  d3.layout.cloud().size([
    800
    300
  ]).words(frequency_list).rotate(0).fontSize((d) ->
    d.size
  ).on('end', draw).start()

# ---
# generated by js2coffee 2.2.0
